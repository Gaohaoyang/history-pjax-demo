<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=3, minimum-scale=1, user-scalable=no">
    <title>History API demo</title>
    <style>
    body {
        min-height: 1000px;
    }
    </style>
</head>

<body>
    <h1>History API demo</h1>
    <hr>
    <h2>1. 测试 back(), forward(), go(), length</h2>
    <p><a href="2.html">我们先手动跳转到 2.html</a></p>
    <button id="back">back</button>
    <button id="forward">forward</button>
    <button id="go-1">go(-1)</button>
    <button id="go0">go(0)</button>
    <button id="go1">go(1)</button>
    <button id="go2">go(2)</button>
    <p>history.length: <span id="length"></span></p>
    <h2 id="pushState">2. 测试 pushState(), replaceState()</h2>
    <button id="push1">pushState()</button>
    <button id="replace">replaceState()</button>
    <h2>3. 监听 window.onpopstate 事件</h2>
    <p>state: <span id="state"></span></p>
    <p>location: <span id="location"></span></p>
    <script type="text/javascript">
    document.querySelector('#length').innerHTML = history.length;
    document.querySelector('#back').addEventListener('click', function() {
        history.back();
    });
    document.querySelector('#forward').addEventListener('click', function() {
        history.forward();
    });
    document.querySelector('#go-1').addEventListener('click', function() {
        history.go(-1);
    });
    document.querySelector('#go0').addEventListener('click', function() {
        history.go(0);
        // history.go();
    });
    document.querySelector('#go1').addEventListener('click', function() {
        history.go(1);
    });
    document.querySelector('#go2').addEventListener('click', function() {
        history.go(2);
    });

    //////////////////////////////////////////
    //------------cut line----------------- //
    //////////////////////////////////////////
    ///
    document.querySelector('#push1').addEventListener('click', function() {
        history.pushState('abc', 'pushStatePageTitle', 'pushState.html');
        document.querySelector('#length').innerHTML = history.length; //重新读取历史长度
    });
    document.querySelector('#replace').addEventListener('click', function() {
        history.replaceState('abc2', 'replaceStatePageTitle', 'replaceState.html');
        document.querySelector('#length').innerHTML = history.length;
    });

    //////////////////////////////////////////
    //------------cut line----------------- //
    //////////////////////////////////////////
    
    window.onpopstate = function(event) {
        document.querySelector('#state').innerHTML = event.state;
        document.querySelector('#location').innerHTML = location;
    };
    window.onpopstate = function(event) {
        console.log(event.state);
        console.log(location);
    };
    </script>
</body>

</html>
